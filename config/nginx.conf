server {
    listen 4097;
    
    location / {
        proxy_pass http://127.0.0.1:4096;
        proxy_http_version 1.1;
        proxy_set_header Upgrade $http_upgrade;
        proxy_set_header Connection "upgrade";
        proxy_set_header Host $host;
        
        # Fix missing MIME types
        types {
            application/javascript js mjs;
            text/css css;
            text/html html htm;
            application/json json;
            image/svg+xml svg;
            image/png png;
            image/x-icon ico;
            application/manifest+json webmanifest;
        }
        default_type application/octet-stream;
    }
    
    # Ensure JS files get correct MIME type
    location ~* \.js$ {
        proxy_pass http://127.0.0.1:4096;
        add_header Content-Type application/javascript;
    }
    
    location ~* \.css$ {
        proxy_pass http://127.0.0.1:4096;
        add_header Content-Type text/css;
    }
}
